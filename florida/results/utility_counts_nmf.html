

<style>

    .legend-box {
      cursor: pointer;
    }
    
</style>

<div id="fig_el45641397885944661285250056194"></div>
<script>
function mpld3_load_lib(url, callback){
  var s = document.createElement('script');
  s.src = url;
  s.async = true;
  s.onreadystatechange = s.onload = callback;
  s.onerror = function(){console.warn("failed to load library " + url);};
  document.getElementsByTagName("head")[0].appendChild(s);
}

if(typeof(mpld3) !== "undefined" && mpld3._mpld3IsLoaded){
   // already loaded: just create the figure
   !function(mpld3){
       
    mpld3.register_plugin("interactive_legend", InteractiveLegend);
    InteractiveLegend.prototype = Object.create(mpld3.Plugin.prototype);
    InteractiveLegend.prototype.constructor = InteractiveLegend;
    InteractiveLegend.prototype.requiredProps = ["element_ids", "labels"];
    InteractiveLegend.prototype.defaultProps = {"ax":null,
                                                "alpha_unsel":0.2,
                                                "alpha_over":1.0,
                                                "start_visible":true}
    function InteractiveLegend(fig, props){
        mpld3.Plugin.call(this, fig, props);
    };

    InteractiveLegend.prototype.draw = function(){
        var alpha_unsel = this.props.alpha_unsel;
        var alpha_over = this.props.alpha_over;

        var legendItems = new Array();
        for(var i=0; i<this.props.labels.length; i++){
            var obj = {};
            obj.label = this.props.labels[i];

            var element_id = this.props.element_ids[i];
            mpld3_elements = [];
            for(var j=0; j<element_id.length; j++){
                var mpld3_element = mpld3.get_element(element_id[j], this.fig);

                // mpld3_element might be null in case of Line2D instances
                // for we pass the id for both the line and the markers. Either
                // one might not exist on the D3 side
                if(mpld3_element){
                    mpld3_elements.push(mpld3_element);
                }
            }

            obj.mpld3_elements = mpld3_elements;
            obj.visible = this.props.start_visible[i]; // should become be setable from python side
            legendItems.push(obj);
            set_alphas(obj, false);
        }

        // determine the axes with which this legend is associated
        var ax = this.props.ax
        if(!ax){
            ax = this.fig.axes[0];
        } else{
            ax = mpld3.get_element(ax, this.fig);
        }

        // add a legend group to the canvas of the figure
        var legend = this.fig.canvas.append("svg:g")
                               .attr("class", "legend");

        // add the rectangles
        legend.selectAll("rect")
                .data(legendItems)
                .enter().append("rect")
                .attr("height", 10)
                .attr("width", 25)
                .attr("x", ax.width + ax.position[0] + 25)
                .attr("y",function(d,i) {
                           return ax.position[1] + i * 25 + 10;})
                .attr("stroke", get_color)
                .attr("class", "legend-box")
                .style("fill", function(d, i) {
                           return d.visible ? get_color(d) : "white";})
                .on("click", click).on('mouseover', over).on('mouseout', out);

        // add the labels
        legend.selectAll("text")
              .data(legendItems)
              .enter().append("text")
              .attr("x", function (d) {
                           return ax.width + ax.position[0] + 25 + 40;})
              .attr("y", function(d,i) {
                           return ax.position[1] + i * 25 + 10 + 10 - 1;})
              .text(function(d) { return d.label });


        // specify the action on click
        function click(d,i){
            d.visible = !d.visible;
            d3.select(this)
              .style("fill",function(d, i) {
                return d.visible ? get_color(d) : "white";
              })
            set_alphas(d, false);

        };

        // specify the action on legend overlay 
        function over(d,i){
             set_alphas(d, true);
        };

        // specify the action on legend overlay 
        function out(d,i){
             set_alphas(d, false);
        };

        // helper function for setting alphas
        function set_alphas(d, is_over){
            for(var i=0; i<d.mpld3_elements.length; i++){
                var type = d.mpld3_elements[i].constructor.name;

                if(type =="mpld3_Line"){
                    var current_alpha = d.mpld3_elements[i].props.alpha;
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.select(d.mpld3_elements[i].path[0][0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("stroke-width", is_over ? 
                                alpha_over * d.mpld3_elements[i].props.edgewidth : d.mpld3_elements[i].props.edgewidth);
                } else if((type=="mpld3_PathCollection")||
                         (type=="mpld3_Markers")){
                    var current_alpha = d.mpld3_elements[i].props.alphas[0];
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.selectAll(d.mpld3_elements[i].pathsobj[0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("fill-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel));
                } else{
                    console.log(type + " not yet supported");
                }
            }
        };


        // helper function for determining the color of the rectangles
        function get_color(d){
            var type = d.mpld3_elements[0].constructor.name;
            var color = "black";
            if(type =="mpld3_Line"){
                color = d.mpld3_elements[0].props.edgecolor;
            } else if((type=="mpld3_PathCollection")||
                      (type=="mpld3_Markers")){
                color = d.mpld3_elements[0].props.facecolors[0];
            } else{
                console.log(type + " not yet supported");
            }
            return color;
        };
    };
    
       mpld3.draw_figure("fig_el45641397885944661285250056194", {"axes": [{"xlim": [736572.65, 736602.35], "yscale": "linear", "axesbg": "#FFFFFF", "texts": [{"v_baseline": "hanging", "h_anchor": "middle", "color": "#000000", "text": "Time", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [0.49999999999999994, -0.024531024531024515], "rotation": -0.0, "id": "el4564139788575927696"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Number of Tweets Per Day", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [-0.0082054228569865, 0.5], "rotation": -90.0, "id": "el4564139788575986192"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Topics Distribution During Hurricane Irma (NMF) (utility_counts)", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 12.0, "position": [0.49999999999999994, 1.0069822650467812], "rotation": -0.0, "id": "el4564139788576029840"}], "zoomable": true, "images": [], "xdomain": [[2017, 7, 31, 15, 36, 0, 0.0], [2017, 8, 30, 8, 24, 0, 0.0]], "ylim": [-16.0, 336.0], "paths": [], "sharey": [], "sharex": [], "axesbgalpha": null, "axes": [{"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "bottom", "nticks": 10, "tickvalues": null}, {"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "left", "nticks": 9, "tickvalues": null}], "lines": [{"drawstyle": "default", "color": "#1F77B4", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el4564139788575986640"}, {"drawstyle": "default", "color": "#FF7F0E", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data02", "id": "el4564139788575643600"}, {"drawstyle": "default", "color": "#98DF8A", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data03", "id": "el4564139788575644432"}, {"drawstyle": "default", "color": "#FF9896", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data04", "id": "el4564139788575645520"}, {"drawstyle": "default", "color": "#8C564B", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data05", "id": "el4564139788575994768"}, {"drawstyle": "default", "color": "#E377C2", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data06", "id": "el4564139788575995792"}, {"drawstyle": "default", "color": "#C7C7C7", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data07", "id": "el4564139788575996816"}, {"drawstyle": "default", "color": "#DBDB8D", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data08", "id": "el4564139788575997840"}], "markers": [], "id": "el4564139788575925008", "ydomain": [-16.0, 336.0], "collections": [], "xscale": "date", "bbox": [0.125, 0.10999999999999999, 0.775, 0.77]}], "height": 1550.0, "width": 6550.0, "plugins": [{"type": "reset"}, {"enabled": false, "button": true, "type": "zoom"}, {"enabled": false, "button": true, "type": "boxzoom"}, {"alpha_over": 1.0, "element_ids": [["el4564139788575986640", "el4564139788575986640pts"], ["el4564139788575643600", "el4564139788575643600pts"], ["el4564139788575644432", "el4564139788575644432pts"], ["el4564139788575645520", "el4564139788575645520pts"], ["el4564139788575994768", "el4564139788575994768pts"], ["el4564139788575995792", "el4564139788575995792pts"], ["el4564139788575996816", "el4564139788575996816pts"], ["el4564139788575997840", "el4564139788575997840pts"]], "labels": ["storm hit just fpl tropical cat days lost went did", "thank hard working work hurricaneirma getting crews hurricaneimra guys quickly", "residents fl county florida elderly duke city electricity need haven", "power restored lines people days day restore lost hurricaneirma affected", "irma com fpl twitter florida hurricaneirma news status miami outages", "deadline midnight pinellas hours don make meet going just trucks", "damage assessing area assess days just crews seen major duke", "hurricane irma hit duke days energy fl know just season"], "alpha_unsel": 0.2, "ax": null, "start_visible": [true, true, true, true, true, true, true, true], "type": "interactive_legend"}], "data": {"data08": [[736576.0, 2.0], [736577.0, 2.0], [736578.0, 0.0], [736579.0, 4.0], [736580.0, 12.0], [736581.0, 8.0], [736582.0, 34.0], [736583.0, 81.0], [736584.0, 104.0], [736585.0, 97.0], [736586.0, 71.0], [736587.0, 83.0], [736588.0, 62.0], [736589.0, 29.0], [736590.0, 25.0], [736591.0, 14.0], [736592.0, 12.0], [736593.0, 5.0], [736594.0, 3.0], [736595.0, 2.0], [736596.0, 1.0], [736598.0, 5.0], [736599.0, 3.0], [736600.0, 2.0], [736601.0, 1.0]], "data06": [[736577.0, 0.0], [736580.0, 0.0], [736581.0, 0.0], [736582.0, 4.0], [736583.0, 22.0], [736584.0, 37.0], [736585.0, 34.0], [736586.0, 40.0], [736587.0, 95.0], [736588.0, 102.0], [736589.0, 91.0], [736590.0, 57.0], [736591.0, 20.0], [736592.0, 5.0], [736593.0, 1.0], [736594.0, 3.0], [736597.0, 0.0], [736600.0, 1.0]], "data07": [[736578.0, 0.0], [736579.0, 0.0], [736580.0, 3.0], [736581.0, 2.0], [736582.0, 19.0], [736583.0, 169.0], [736584.0, 320.0], [736585.0, 122.0], [736586.0, 101.0], [736587.0, 77.0], [736588.0, 65.0], [736589.0, 26.0], [736590.0, 32.0], [736591.0, 16.0], [736592.0, 4.0], [736593.0, 4.0], [736595.0, 1.0], [736596.0, 0.0], [736597.0, 0.0], [736598.0, 1.0], [736600.0, 0.0], [736601.0, 2.0]], "data04": [[736577.0, 1.0], [736578.0, 0.0], [736580.0, 15.0], [736581.0, 12.0], [736582.0, 52.0], [736583.0, 168.0], [736584.0, 257.0], [736585.0, 250.0], [736586.0, 200.0], [736587.0, 130.0], [736588.0, 113.0], [736589.0, 71.0], [736590.0, 37.0], [736591.0, 24.0], [736592.0, 11.0], [736593.0, 4.0], [736594.0, 7.0], [736595.0, 0.0], [736596.0, 2.0], [736597.0, 3.0], [736598.0, 2.0], [736600.0, 2.0], [736601.0, 1.0]], "data05": [[736574.0, 0.0], [736577.0, 1.0], [736578.0, 0.0], [736579.0, 9.0], [736580.0, 25.0], [736581.0, 15.0], [736582.0, 52.0], [736583.0, 105.0], [736584.0, 141.0], [736585.0, 129.0], [736586.0, 100.0], [736587.0, 80.0], [736588.0, 80.0], [736589.0, 51.0], [736590.0, 35.0], [736591.0, 18.0], [736592.0, 15.0], [736593.0, 11.0], [736594.0, 9.0], [736595.0, 5.0], [736596.0, 1.0], [736597.0, 1.0], [736598.0, 6.0], [736599.0, 1.0], [736600.0, 4.0], [736601.0, 1.0]], "data02": [[736578.0, 0.0], [736579.0, 0.0], [736580.0, 7.0], [736581.0, 9.0], [736582.0, 37.0], [736583.0, 133.0], [736584.0, 110.0], [736585.0, 83.0], [736586.0, 56.0], [736587.0, 44.0], [736588.0, 43.0], [736589.0, 17.0], [736590.0, 18.0], [736591.0, 9.0], [736592.0, 10.0], [736593.0, 2.0], [736594.0, 6.0], [736595.0, 2.0], [736596.0, 0.0], [736597.0, 0.0], [736598.0, 3.0], [736599.0, 0.0]], "data03": [[736578.0, 0.0], [736579.0, 1.0], [736580.0, 3.0], [736581.0, 0.0], [736582.0, 12.0], [736583.0, 41.0], [736584.0, 68.0], [736585.0, 53.0], [736586.0, 45.0], [736587.0, 31.0], [736588.0, 28.0], [736589.0, 21.0], [736590.0, 19.0], [736591.0, 4.0], [736592.0, 0.0], [736593.0, 1.0], [736594.0, 5.0], [736595.0, 0.0], [736597.0, 2.0], [736598.0, 1.0], [736600.0, 0.0], [736601.0, 0.0]], "data01": [[736577.0, 1.0], [736578.0, 5.0], [736579.0, 4.0], [736580.0, 21.0], [736581.0, 22.0], [736582.0, 44.0], [736583.0, 140.0], [736584.0, 182.0], [736585.0, 119.0], [736586.0, 118.0], [736587.0, 86.0], [736588.0, 76.0], [736589.0, 33.0], [736590.0, 25.0], [736591.0, 21.0], [736592.0, 12.0], [736593.0, 5.0], [736594.0, 4.0], [736595.0, 2.0], [736596.0, 1.0], [736597.0, 2.0], [736599.0, 1.0], [736600.0, 5.0], [736601.0, 0.0]]}, "id": "el4564139788594466128"});
   }(mpld3);
}else if(typeof define === "function" && define.amd){
   // require.js is available: use it to load d3/mpld3
   require.config({paths: {d3: "https://mpld3.github.io/js/d3.v3.min"}});
   require(["d3"], function(d3){
      window.d3 = d3;
      mpld3_load_lib("https://mpld3.github.io/js/mpld3.v0.3.js", function(){
         
    mpld3.register_plugin("interactive_legend", InteractiveLegend);
    InteractiveLegend.prototype = Object.create(mpld3.Plugin.prototype);
    InteractiveLegend.prototype.constructor = InteractiveLegend;
    InteractiveLegend.prototype.requiredProps = ["element_ids", "labels"];
    InteractiveLegend.prototype.defaultProps = {"ax":null,
                                                "alpha_unsel":0.2,
                                                "alpha_over":1.0,
                                                "start_visible":true}
    function InteractiveLegend(fig, props){
        mpld3.Plugin.call(this, fig, props);
    };

    InteractiveLegend.prototype.draw = function(){
        var alpha_unsel = this.props.alpha_unsel;
        var alpha_over = this.props.alpha_over;

        var legendItems = new Array();
        for(var i=0; i<this.props.labels.length; i++){
            var obj = {};
            obj.label = this.props.labels[i];

            var element_id = this.props.element_ids[i];
            mpld3_elements = [];
            for(var j=0; j<element_id.length; j++){
                var mpld3_element = mpld3.get_element(element_id[j], this.fig);

                // mpld3_element might be null in case of Line2D instances
                // for we pass the id for both the line and the markers. Either
                // one might not exist on the D3 side
                if(mpld3_element){
                    mpld3_elements.push(mpld3_element);
                }
            }

            obj.mpld3_elements = mpld3_elements;
            obj.visible = this.props.start_visible[i]; // should become be setable from python side
            legendItems.push(obj);
            set_alphas(obj, false);
        }

        // determine the axes with which this legend is associated
        var ax = this.props.ax
        if(!ax){
            ax = this.fig.axes[0];
        } else{
            ax = mpld3.get_element(ax, this.fig);
        }

        // add a legend group to the canvas of the figure
        var legend = this.fig.canvas.append("svg:g")
                               .attr("class", "legend");

        // add the rectangles
        legend.selectAll("rect")
                .data(legendItems)
                .enter().append("rect")
                .attr("height", 10)
                .attr("width", 25)
                .attr("x", ax.width + ax.position[0] + 25)
                .attr("y",function(d,i) {
                           return ax.position[1] + i * 25 + 10;})
                .attr("stroke", get_color)
                .attr("class", "legend-box")
                .style("fill", function(d, i) {
                           return d.visible ? get_color(d) : "white";})
                .on("click", click).on('mouseover', over).on('mouseout', out);

        // add the labels
        legend.selectAll("text")
              .data(legendItems)
              .enter().append("text")
              .attr("x", function (d) {
                           return ax.width + ax.position[0] + 25 + 40;})
              .attr("y", function(d,i) {
                           return ax.position[1] + i * 25 + 10 + 10 - 1;})
              .text(function(d) { return d.label });


        // specify the action on click
        function click(d,i){
            d.visible = !d.visible;
            d3.select(this)
              .style("fill",function(d, i) {
                return d.visible ? get_color(d) : "white";
              })
            set_alphas(d, false);

        };

        // specify the action on legend overlay 
        function over(d,i){
             set_alphas(d, true);
        };

        // specify the action on legend overlay 
        function out(d,i){
             set_alphas(d, false);
        };

        // helper function for setting alphas
        function set_alphas(d, is_over){
            for(var i=0; i<d.mpld3_elements.length; i++){
                var type = d.mpld3_elements[i].constructor.name;

                if(type =="mpld3_Line"){
                    var current_alpha = d.mpld3_elements[i].props.alpha;
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.select(d.mpld3_elements[i].path[0][0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("stroke-width", is_over ? 
                                alpha_over * d.mpld3_elements[i].props.edgewidth : d.mpld3_elements[i].props.edgewidth);
                } else if((type=="mpld3_PathCollection")||
                         (type=="mpld3_Markers")){
                    var current_alpha = d.mpld3_elements[i].props.alphas[0];
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.selectAll(d.mpld3_elements[i].pathsobj[0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("fill-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel));
                } else{
                    console.log(type + " not yet supported");
                }
            }
        };


        // helper function for determining the color of the rectangles
        function get_color(d){
            var type = d.mpld3_elements[0].constructor.name;
            var color = "black";
            if(type =="mpld3_Line"){
                color = d.mpld3_elements[0].props.edgecolor;
            } else if((type=="mpld3_PathCollection")||
                      (type=="mpld3_Markers")){
                color = d.mpld3_elements[0].props.facecolors[0];
            } else{
                console.log(type + " not yet supported");
            }
            return color;
        };
    };
    
         mpld3.draw_figure("fig_el45641397885944661285250056194", {"axes": [{"xlim": [736572.65, 736602.35], "yscale": "linear", "axesbg": "#FFFFFF", "texts": [{"v_baseline": "hanging", "h_anchor": "middle", "color": "#000000", "text": "Time", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [0.49999999999999994, -0.024531024531024515], "rotation": -0.0, "id": "el4564139788575927696"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Number of Tweets Per Day", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [-0.0082054228569865, 0.5], "rotation": -90.0, "id": "el4564139788575986192"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Topics Distribution During Hurricane Irma (NMF) (utility_counts)", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 12.0, "position": [0.49999999999999994, 1.0069822650467812], "rotation": -0.0, "id": "el4564139788576029840"}], "zoomable": true, "images": [], "xdomain": [[2017, 7, 31, 15, 36, 0, 0.0], [2017, 8, 30, 8, 24, 0, 0.0]], "ylim": [-16.0, 336.0], "paths": [], "sharey": [], "sharex": [], "axesbgalpha": null, "axes": [{"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "bottom", "nticks": 10, "tickvalues": null}, {"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "left", "nticks": 9, "tickvalues": null}], "lines": [{"drawstyle": "default", "color": "#1F77B4", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el4564139788575986640"}, {"drawstyle": "default", "color": "#FF7F0E", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data02", "id": "el4564139788575643600"}, {"drawstyle": "default", "color": "#98DF8A", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data03", "id": "el4564139788575644432"}, {"drawstyle": "default", "color": "#FF9896", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data04", "id": "el4564139788575645520"}, {"drawstyle": "default", "color": "#8C564B", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data05", "id": "el4564139788575994768"}, {"drawstyle": "default", "color": "#E377C2", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data06", "id": "el4564139788575995792"}, {"drawstyle": "default", "color": "#C7C7C7", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data07", "id": "el4564139788575996816"}, {"drawstyle": "default", "color": "#DBDB8D", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data08", "id": "el4564139788575997840"}], "markers": [], "id": "el4564139788575925008", "ydomain": [-16.0, 336.0], "collections": [], "xscale": "date", "bbox": [0.125, 0.10999999999999999, 0.775, 0.77]}], "height": 1550.0, "width": 6550.0, "plugins": [{"type": "reset"}, {"enabled": false, "button": true, "type": "zoom"}, {"enabled": false, "button": true, "type": "boxzoom"}, {"alpha_over": 1.0, "element_ids": [["el4564139788575986640", "el4564139788575986640pts"], ["el4564139788575643600", "el4564139788575643600pts"], ["el4564139788575644432", "el4564139788575644432pts"], ["el4564139788575645520", "el4564139788575645520pts"], ["el4564139788575994768", "el4564139788575994768pts"], ["el4564139788575995792", "el4564139788575995792pts"], ["el4564139788575996816", "el4564139788575996816pts"], ["el4564139788575997840", "el4564139788575997840pts"]], "labels": ["storm hit just fpl tropical cat days lost went did", "thank hard working work hurricaneirma getting crews hurricaneimra guys quickly", "residents fl county florida elderly duke city electricity need haven", "power restored lines people days day restore lost hurricaneirma affected", "irma com fpl twitter florida hurricaneirma news status miami outages", "deadline midnight pinellas hours don make meet going just trucks", "damage assessing area assess days just crews seen major duke", "hurricane irma hit duke days energy fl know just season"], "alpha_unsel": 0.2, "ax": null, "start_visible": [true, true, true, true, true, true, true, true], "type": "interactive_legend"}], "data": {"data08": [[736576.0, 2.0], [736577.0, 2.0], [736578.0, 0.0], [736579.0, 4.0], [736580.0, 12.0], [736581.0, 8.0], [736582.0, 34.0], [736583.0, 81.0], [736584.0, 104.0], [736585.0, 97.0], [736586.0, 71.0], [736587.0, 83.0], [736588.0, 62.0], [736589.0, 29.0], [736590.0, 25.0], [736591.0, 14.0], [736592.0, 12.0], [736593.0, 5.0], [736594.0, 3.0], [736595.0, 2.0], [736596.0, 1.0], [736598.0, 5.0], [736599.0, 3.0], [736600.0, 2.0], [736601.0, 1.0]], "data06": [[736577.0, 0.0], [736580.0, 0.0], [736581.0, 0.0], [736582.0, 4.0], [736583.0, 22.0], [736584.0, 37.0], [736585.0, 34.0], [736586.0, 40.0], [736587.0, 95.0], [736588.0, 102.0], [736589.0, 91.0], [736590.0, 57.0], [736591.0, 20.0], [736592.0, 5.0], [736593.0, 1.0], [736594.0, 3.0], [736597.0, 0.0], [736600.0, 1.0]], "data07": [[736578.0, 0.0], [736579.0, 0.0], [736580.0, 3.0], [736581.0, 2.0], [736582.0, 19.0], [736583.0, 169.0], [736584.0, 320.0], [736585.0, 122.0], [736586.0, 101.0], [736587.0, 77.0], [736588.0, 65.0], [736589.0, 26.0], [736590.0, 32.0], [736591.0, 16.0], [736592.0, 4.0], [736593.0, 4.0], [736595.0, 1.0], [736596.0, 0.0], [736597.0, 0.0], [736598.0, 1.0], [736600.0, 0.0], [736601.0, 2.0]], "data04": [[736577.0, 1.0], [736578.0, 0.0], [736580.0, 15.0], [736581.0, 12.0], [736582.0, 52.0], [736583.0, 168.0], [736584.0, 257.0], [736585.0, 250.0], [736586.0, 200.0], [736587.0, 130.0], [736588.0, 113.0], [736589.0, 71.0], [736590.0, 37.0], [736591.0, 24.0], [736592.0, 11.0], [736593.0, 4.0], [736594.0, 7.0], [736595.0, 0.0], [736596.0, 2.0], [736597.0, 3.0], [736598.0, 2.0], [736600.0, 2.0], [736601.0, 1.0]], "data05": [[736574.0, 0.0], [736577.0, 1.0], [736578.0, 0.0], [736579.0, 9.0], [736580.0, 25.0], [736581.0, 15.0], [736582.0, 52.0], [736583.0, 105.0], [736584.0, 141.0], [736585.0, 129.0], [736586.0, 100.0], [736587.0, 80.0], [736588.0, 80.0], [736589.0, 51.0], [736590.0, 35.0], [736591.0, 18.0], [736592.0, 15.0], [736593.0, 11.0], [736594.0, 9.0], [736595.0, 5.0], [736596.0, 1.0], [736597.0, 1.0], [736598.0, 6.0], [736599.0, 1.0], [736600.0, 4.0], [736601.0, 1.0]], "data02": [[736578.0, 0.0], [736579.0, 0.0], [736580.0, 7.0], [736581.0, 9.0], [736582.0, 37.0], [736583.0, 133.0], [736584.0, 110.0], [736585.0, 83.0], [736586.0, 56.0], [736587.0, 44.0], [736588.0, 43.0], [736589.0, 17.0], [736590.0, 18.0], [736591.0, 9.0], [736592.0, 10.0], [736593.0, 2.0], [736594.0, 6.0], [736595.0, 2.0], [736596.0, 0.0], [736597.0, 0.0], [736598.0, 3.0], [736599.0, 0.0]], "data03": [[736578.0, 0.0], [736579.0, 1.0], [736580.0, 3.0], [736581.0, 0.0], [736582.0, 12.0], [736583.0, 41.0], [736584.0, 68.0], [736585.0, 53.0], [736586.0, 45.0], [736587.0, 31.0], [736588.0, 28.0], [736589.0, 21.0], [736590.0, 19.0], [736591.0, 4.0], [736592.0, 0.0], [736593.0, 1.0], [736594.0, 5.0], [736595.0, 0.0], [736597.0, 2.0], [736598.0, 1.0], [736600.0, 0.0], [736601.0, 0.0]], "data01": [[736577.0, 1.0], [736578.0, 5.0], [736579.0, 4.0], [736580.0, 21.0], [736581.0, 22.0], [736582.0, 44.0], [736583.0, 140.0], [736584.0, 182.0], [736585.0, 119.0], [736586.0, 118.0], [736587.0, 86.0], [736588.0, 76.0], [736589.0, 33.0], [736590.0, 25.0], [736591.0, 21.0], [736592.0, 12.0], [736593.0, 5.0], [736594.0, 4.0], [736595.0, 2.0], [736596.0, 1.0], [736597.0, 2.0], [736599.0, 1.0], [736600.0, 5.0], [736601.0, 0.0]]}, "id": "el4564139788594466128"});
      });
    });
}else{
    // require.js not available: dynamically load d3 & mpld3
    mpld3_load_lib("https://mpld3.github.io/js/d3.v3.min.js", function(){
         mpld3_load_lib("https://mpld3.github.io/js/mpld3.v0.3.js", function(){
                 
    mpld3.register_plugin("interactive_legend", InteractiveLegend);
    InteractiveLegend.prototype = Object.create(mpld3.Plugin.prototype);
    InteractiveLegend.prototype.constructor = InteractiveLegend;
    InteractiveLegend.prototype.requiredProps = ["element_ids", "labels"];
    InteractiveLegend.prototype.defaultProps = {"ax":null,
                                                "alpha_unsel":0.2,
                                                "alpha_over":1.0,
                                                "start_visible":true}
    function InteractiveLegend(fig, props){
        mpld3.Plugin.call(this, fig, props);
    };

    InteractiveLegend.prototype.draw = function(){
        var alpha_unsel = this.props.alpha_unsel;
        var alpha_over = this.props.alpha_over;

        var legendItems = new Array();
        for(var i=0; i<this.props.labels.length; i++){
            var obj = {};
            obj.label = this.props.labels[i];

            var element_id = this.props.element_ids[i];
            mpld3_elements = [];
            for(var j=0; j<element_id.length; j++){
                var mpld3_element = mpld3.get_element(element_id[j], this.fig);

                // mpld3_element might be null in case of Line2D instances
                // for we pass the id for both the line and the markers. Either
                // one might not exist on the D3 side
                if(mpld3_element){
                    mpld3_elements.push(mpld3_element);
                }
            }

            obj.mpld3_elements = mpld3_elements;
            obj.visible = this.props.start_visible[i]; // should become be setable from python side
            legendItems.push(obj);
            set_alphas(obj, false);
        }

        // determine the axes with which this legend is associated
        var ax = this.props.ax
        if(!ax){
            ax = this.fig.axes[0];
        } else{
            ax = mpld3.get_element(ax, this.fig);
        }

        // add a legend group to the canvas of the figure
        var legend = this.fig.canvas.append("svg:g")
                               .attr("class", "legend");

        // add the rectangles
        legend.selectAll("rect")
                .data(legendItems)
                .enter().append("rect")
                .attr("height", 10)
                .attr("width", 25)
                .attr("x", ax.width + ax.position[0] + 25)
                .attr("y",function(d,i) {
                           return ax.position[1] + i * 25 + 10;})
                .attr("stroke", get_color)
                .attr("class", "legend-box")
                .style("fill", function(d, i) {
                           return d.visible ? get_color(d) : "white";})
                .on("click", click).on('mouseover', over).on('mouseout', out);

        // add the labels
        legend.selectAll("text")
              .data(legendItems)
              .enter().append("text")
              .attr("x", function (d) {
                           return ax.width + ax.position[0] + 25 + 40;})
              .attr("y", function(d,i) {
                           return ax.position[1] + i * 25 + 10 + 10 - 1;})
              .text(function(d) { return d.label });


        // specify the action on click
        function click(d,i){
            d.visible = !d.visible;
            d3.select(this)
              .style("fill",function(d, i) {
                return d.visible ? get_color(d) : "white";
              })
            set_alphas(d, false);

        };

        // specify the action on legend overlay 
        function over(d,i){
             set_alphas(d, true);
        };

        // specify the action on legend overlay 
        function out(d,i){
             set_alphas(d, false);
        };

        // helper function for setting alphas
        function set_alphas(d, is_over){
            for(var i=0; i<d.mpld3_elements.length; i++){
                var type = d.mpld3_elements[i].constructor.name;

                if(type =="mpld3_Line"){
                    var current_alpha = d.mpld3_elements[i].props.alpha;
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.select(d.mpld3_elements[i].path[0][0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("stroke-width", is_over ? 
                                alpha_over * d.mpld3_elements[i].props.edgewidth : d.mpld3_elements[i].props.edgewidth);
                } else if((type=="mpld3_PathCollection")||
                         (type=="mpld3_Markers")){
                    var current_alpha = d.mpld3_elements[i].props.alphas[0];
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.selectAll(d.mpld3_elements[i].pathsobj[0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("fill-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel));
                } else{
                    console.log(type + " not yet supported");
                }
            }
        };


        // helper function for determining the color of the rectangles
        function get_color(d){
            var type = d.mpld3_elements[0].constructor.name;
            var color = "black";
            if(type =="mpld3_Line"){
                color = d.mpld3_elements[0].props.edgecolor;
            } else if((type=="mpld3_PathCollection")||
                      (type=="mpld3_Markers")){
                color = d.mpld3_elements[0].props.facecolors[0];
            } else{
                console.log(type + " not yet supported");
            }
            return color;
        };
    };
    
                 mpld3.draw_figure("fig_el45641397885944661285250056194", {"axes": [{"xlim": [736572.65, 736602.35], "yscale": "linear", "axesbg": "#FFFFFF", "texts": [{"v_baseline": "hanging", "h_anchor": "middle", "color": "#000000", "text": "Time", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [0.49999999999999994, -0.024531024531024515], "rotation": -0.0, "id": "el4564139788575927696"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Number of Tweets Per Day", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [-0.0082054228569865, 0.5], "rotation": -90.0, "id": "el4564139788575986192"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Topics Distribution During Hurricane Irma (NMF) (utility_counts)", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 12.0, "position": [0.49999999999999994, 1.0069822650467812], "rotation": -0.0, "id": "el4564139788576029840"}], "zoomable": true, "images": [], "xdomain": [[2017, 7, 31, 15, 36, 0, 0.0], [2017, 8, 30, 8, 24, 0, 0.0]], "ylim": [-16.0, 336.0], "paths": [], "sharey": [], "sharex": [], "axesbgalpha": null, "axes": [{"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "bottom", "nticks": 10, "tickvalues": null}, {"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "left", "nticks": 9, "tickvalues": null}], "lines": [{"drawstyle": "default", "color": "#1F77B4", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el4564139788575986640"}, {"drawstyle": "default", "color": "#FF7F0E", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data02", "id": "el4564139788575643600"}, {"drawstyle": "default", "color": "#98DF8A", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data03", "id": "el4564139788575644432"}, {"drawstyle": "default", "color": "#FF9896", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data04", "id": "el4564139788575645520"}, {"drawstyle": "default", "color": "#8C564B", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data05", "id": "el4564139788575994768"}, {"drawstyle": "default", "color": "#E377C2", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data06", "id": "el4564139788575995792"}, {"drawstyle": "default", "color": "#C7C7C7", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data07", "id": "el4564139788575996816"}, {"drawstyle": "default", "color": "#DBDB8D", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data08", "id": "el4564139788575997840"}], "markers": [], "id": "el4564139788575925008", "ydomain": [-16.0, 336.0], "collections": [], "xscale": "date", "bbox": [0.125, 0.10999999999999999, 0.775, 0.77]}], "height": 1550.0, "width": 6550.0, "plugins": [{"type": "reset"}, {"enabled": false, "button": true, "type": "zoom"}, {"enabled": false, "button": true, "type": "boxzoom"}, {"alpha_over": 1.0, "element_ids": [["el4564139788575986640", "el4564139788575986640pts"], ["el4564139788575643600", "el4564139788575643600pts"], ["el4564139788575644432", "el4564139788575644432pts"], ["el4564139788575645520", "el4564139788575645520pts"], ["el4564139788575994768", "el4564139788575994768pts"], ["el4564139788575995792", "el4564139788575995792pts"], ["el4564139788575996816", "el4564139788575996816pts"], ["el4564139788575997840", "el4564139788575997840pts"]], "labels": ["storm hit just fpl tropical cat days lost went did", "thank hard working work hurricaneirma getting crews hurricaneimra guys quickly", "residents fl county florida elderly duke city electricity need haven", "power restored lines people days day restore lost hurricaneirma affected", "irma com fpl twitter florida hurricaneirma news status miami outages", "deadline midnight pinellas hours don make meet going just trucks", "damage assessing area assess days just crews seen major duke", "hurricane irma hit duke days energy fl know just season"], "alpha_unsel": 0.2, "ax": null, "start_visible": [true, true, true, true, true, true, true, true], "type": "interactive_legend"}], "data": {"data08": [[736576.0, 2.0], [736577.0, 2.0], [736578.0, 0.0], [736579.0, 4.0], [736580.0, 12.0], [736581.0, 8.0], [736582.0, 34.0], [736583.0, 81.0], [736584.0, 104.0], [736585.0, 97.0], [736586.0, 71.0], [736587.0, 83.0], [736588.0, 62.0], [736589.0, 29.0], [736590.0, 25.0], [736591.0, 14.0], [736592.0, 12.0], [736593.0, 5.0], [736594.0, 3.0], [736595.0, 2.0], [736596.0, 1.0], [736598.0, 5.0], [736599.0, 3.0], [736600.0, 2.0], [736601.0, 1.0]], "data06": [[736577.0, 0.0], [736580.0, 0.0], [736581.0, 0.0], [736582.0, 4.0], [736583.0, 22.0], [736584.0, 37.0], [736585.0, 34.0], [736586.0, 40.0], [736587.0, 95.0], [736588.0, 102.0], [736589.0, 91.0], [736590.0, 57.0], [736591.0, 20.0], [736592.0, 5.0], [736593.0, 1.0], [736594.0, 3.0], [736597.0, 0.0], [736600.0, 1.0]], "data07": [[736578.0, 0.0], [736579.0, 0.0], [736580.0, 3.0], [736581.0, 2.0], [736582.0, 19.0], [736583.0, 169.0], [736584.0, 320.0], [736585.0, 122.0], [736586.0, 101.0], [736587.0, 77.0], [736588.0, 65.0], [736589.0, 26.0], [736590.0, 32.0], [736591.0, 16.0], [736592.0, 4.0], [736593.0, 4.0], [736595.0, 1.0], [736596.0, 0.0], [736597.0, 0.0], [736598.0, 1.0], [736600.0, 0.0], [736601.0, 2.0]], "data04": [[736577.0, 1.0], [736578.0, 0.0], [736580.0, 15.0], [736581.0, 12.0], [736582.0, 52.0], [736583.0, 168.0], [736584.0, 257.0], [736585.0, 250.0], [736586.0, 200.0], [736587.0, 130.0], [736588.0, 113.0], [736589.0, 71.0], [736590.0, 37.0], [736591.0, 24.0], [736592.0, 11.0], [736593.0, 4.0], [736594.0, 7.0], [736595.0, 0.0], [736596.0, 2.0], [736597.0, 3.0], [736598.0, 2.0], [736600.0, 2.0], [736601.0, 1.0]], "data05": [[736574.0, 0.0], [736577.0, 1.0], [736578.0, 0.0], [736579.0, 9.0], [736580.0, 25.0], [736581.0, 15.0], [736582.0, 52.0], [736583.0, 105.0], [736584.0, 141.0], [736585.0, 129.0], [736586.0, 100.0], [736587.0, 80.0], [736588.0, 80.0], [736589.0, 51.0], [736590.0, 35.0], [736591.0, 18.0], [736592.0, 15.0], [736593.0, 11.0], [736594.0, 9.0], [736595.0, 5.0], [736596.0, 1.0], [736597.0, 1.0], [736598.0, 6.0], [736599.0, 1.0], [736600.0, 4.0], [736601.0, 1.0]], "data02": [[736578.0, 0.0], [736579.0, 0.0], [736580.0, 7.0], [736581.0, 9.0], [736582.0, 37.0], [736583.0, 133.0], [736584.0, 110.0], [736585.0, 83.0], [736586.0, 56.0], [736587.0, 44.0], [736588.0, 43.0], [736589.0, 17.0], [736590.0, 18.0], [736591.0, 9.0], [736592.0, 10.0], [736593.0, 2.0], [736594.0, 6.0], [736595.0, 2.0], [736596.0, 0.0], [736597.0, 0.0], [736598.0, 3.0], [736599.0, 0.0]], "data03": [[736578.0, 0.0], [736579.0, 1.0], [736580.0, 3.0], [736581.0, 0.0], [736582.0, 12.0], [736583.0, 41.0], [736584.0, 68.0], [736585.0, 53.0], [736586.0, 45.0], [736587.0, 31.0], [736588.0, 28.0], [736589.0, 21.0], [736590.0, 19.0], [736591.0, 4.0], [736592.0, 0.0], [736593.0, 1.0], [736594.0, 5.0], [736595.0, 0.0], [736597.0, 2.0], [736598.0, 1.0], [736600.0, 0.0], [736601.0, 0.0]], "data01": [[736577.0, 1.0], [736578.0, 5.0], [736579.0, 4.0], [736580.0, 21.0], [736581.0, 22.0], [736582.0, 44.0], [736583.0, 140.0], [736584.0, 182.0], [736585.0, 119.0], [736586.0, 118.0], [736587.0, 86.0], [736588.0, 76.0], [736589.0, 33.0], [736590.0, 25.0], [736591.0, 21.0], [736592.0, 12.0], [736593.0, 5.0], [736594.0, 4.0], [736595.0, 2.0], [736596.0, 1.0], [736597.0, 2.0], [736599.0, 1.0], [736600.0, 5.0], [736601.0, 0.0]]}, "id": "el4564139788594466128"});
            })
         });
}
</script>