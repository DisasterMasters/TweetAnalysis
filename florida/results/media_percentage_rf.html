

<style>

    .legend-box {
      cursor: pointer;
    }
    
</style>

<div id="fig_el30181405371040968486259833367"></div>
<script>
function mpld3_load_lib(url, callback){
  var s = document.createElement('script');
  s.src = url;
  s.async = true;
  s.onreadystatechange = s.onload = callback;
  s.onerror = function(){console.warn("failed to load library " + url);};
  document.getElementsByTagName("head")[0].appendChild(s);
}

if(typeof(mpld3) !== "undefined" && mpld3._mpld3IsLoaded){
   // already loaded: just create the figure
   !function(mpld3){
       
    mpld3.register_plugin("interactive_legend", InteractiveLegend);
    InteractiveLegend.prototype = Object.create(mpld3.Plugin.prototype);
    InteractiveLegend.prototype.constructor = InteractiveLegend;
    InteractiveLegend.prototype.requiredProps = ["element_ids", "labels"];
    InteractiveLegend.prototype.defaultProps = {"ax":null,
                                                "alpha_unsel":0.2,
                                                "alpha_over":1.0,
                                                "start_visible":true}
    function InteractiveLegend(fig, props){
        mpld3.Plugin.call(this, fig, props);
    };

    InteractiveLegend.prototype.draw = function(){
        var alpha_unsel = this.props.alpha_unsel;
        var alpha_over = this.props.alpha_over;

        var legendItems = new Array();
        for(var i=0; i<this.props.labels.length; i++){
            var obj = {};
            obj.label = this.props.labels[i];

            var element_id = this.props.element_ids[i];
            mpld3_elements = [];
            for(var j=0; j<element_id.length; j++){
                var mpld3_element = mpld3.get_element(element_id[j], this.fig);

                // mpld3_element might be null in case of Line2D instances
                // for we pass the id for both the line and the markers. Either
                // one might not exist on the D3 side
                if(mpld3_element){
                    mpld3_elements.push(mpld3_element);
                }
            }

            obj.mpld3_elements = mpld3_elements;
            obj.visible = this.props.start_visible[i]; // should become be setable from python side
            legendItems.push(obj);
            set_alphas(obj, false);
        }

        // determine the axes with which this legend is associated
        var ax = this.props.ax
        if(!ax){
            ax = this.fig.axes[0];
        } else{
            ax = mpld3.get_element(ax, this.fig);
        }

        // add a legend group to the canvas of the figure
        var legend = this.fig.canvas.append("svg:g")
                               .attr("class", "legend");

        // add the rectangles
        legend.selectAll("rect")
                .data(legendItems)
                .enter().append("rect")
                .attr("height", 10)
                .attr("width", 25)
                .attr("x", ax.width + ax.position[0] + 25)
                .attr("y",function(d,i) {
                           return ax.position[1] + i * 25 + 10;})
                .attr("stroke", get_color)
                .attr("class", "legend-box")
                .style("fill", function(d, i) {
                           return d.visible ? get_color(d) : "white";})
                .on("click", click).on('mouseover', over).on('mouseout', out);

        // add the labels
        legend.selectAll("text")
              .data(legendItems)
              .enter().append("text")
              .attr("x", function (d) {
                           return ax.width + ax.position[0] + 25 + 40;})
              .attr("y", function(d,i) {
                           return ax.position[1] + i * 25 + 10 + 10 - 1;})
              .text(function(d) { return d.label });


        // specify the action on click
        function click(d,i){
            d.visible = !d.visible;
            d3.select(this)
              .style("fill",function(d, i) {
                return d.visible ? get_color(d) : "white";
              })
            set_alphas(d, false);

        };

        // specify the action on legend overlay 
        function over(d,i){
             set_alphas(d, true);
        };

        // specify the action on legend overlay 
        function out(d,i){
             set_alphas(d, false);
        };

        // helper function for setting alphas
        function set_alphas(d, is_over){
            for(var i=0; i<d.mpld3_elements.length; i++){
                var type = d.mpld3_elements[i].constructor.name;

                if(type =="mpld3_Line"){
                    var current_alpha = d.mpld3_elements[i].props.alpha;
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.select(d.mpld3_elements[i].path[0][0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("stroke-width", is_over ? 
                                alpha_over * d.mpld3_elements[i].props.edgewidth : d.mpld3_elements[i].props.edgewidth);
                } else if((type=="mpld3_PathCollection")||
                         (type=="mpld3_Markers")){
                    var current_alpha = d.mpld3_elements[i].props.alphas[0];
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.selectAll(d.mpld3_elements[i].pathsobj[0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("fill-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel));
                } else{
                    console.log(type + " not yet supported");
                }
            }
        };


        // helper function for determining the color of the rectangles
        function get_color(d){
            var type = d.mpld3_elements[0].constructor.name;
            var color = "black";
            if(type =="mpld3_Line"){
                color = d.mpld3_elements[0].props.edgecolor;
            } else if((type=="mpld3_PathCollection")||
                      (type=="mpld3_Markers")){
                color = d.mpld3_elements[0].props.facecolors[0];
            } else{
                console.log(type + " not yet supported");
            }
            return color;
        };
    };
    
       mpld3.draw_figure("fig_el30181405371040968486259833367", {"axes": [{"xlim": [736572.65, 736602.35], "yscale": "linear", "axesbg": "#FFFFFF", "texts": [{"v_baseline": "hanging", "h_anchor": "middle", "color": "#000000", "text": "Time", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [0.5, -0.030418470418470414], "rotation": -0.0, "id": "el3018140537087717008"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Number of Tweets Per Day", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [-0.022411577737201593, 0.5], "rotation": -90.0, "id": "el3018140537087775504"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Topics Distribution During Hurricane Irma (Random Forest) (media_percentage)", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 12.0, "position": [0.5, 1.0086580086580086], "rotation": -0.0, "id": "el3018140537087815056"}], "zoomable": true, "images": [], "xdomain": [[2017, 7, 31, 15, 36, 0, 0.0], [2017, 8, 30, 8, 24, 0, 0.0]], "ylim": [-0.013131313131313133, 0.27575757575757576], "paths": [], "sharey": [], "sharex": [], "axesbgalpha": null, "axes": [{"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "bottom", "nticks": 10, "tickvalues": null}, {"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "left", "nticks": 8, "tickvalues": null}], "lines": [{"drawstyle": "default", "color": "#1F77B4", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537087775952"}, {"drawstyle": "default", "color": "#AEC7E8", "yindex": 2, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085266128"}, {"drawstyle": "default", "color": "#FF7F0E", "yindex": 3, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085266960"}, {"drawstyle": "default", "color": "#2CA02C", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data02", "id": "el3018140537085386896"}, {"drawstyle": "default", "color": "#98DF8A", "yindex": 4, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085387920"}, {"drawstyle": "default", "color": "#D62728", "yindex": 5, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085388944"}, {"drawstyle": "default", "color": "#9467BD", "yindex": 6, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085389968"}, {"drawstyle": "default", "color": "#C5B0D5", "yindex": 7, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085427920"}, {"drawstyle": "default", "color": "#8C564B", "yindex": 8, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085428944"}, {"drawstyle": "default", "color": "#E377C2", "yindex": 9, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085429968"}, {"drawstyle": "default", "color": "#F7B6D2", "yindex": 10, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085430992"}, {"drawstyle": "default", "color": "#7F7F7F", "yindex": 11, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084952848"}, {"drawstyle": "default", "color": "#BCBD22", "yindex": 12, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084953872"}, {"drawstyle": "default", "color": "#DBDB8D", "yindex": 13, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084954896"}, {"drawstyle": "default", "color": "#17BECF", "yindex": 14, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084955920"}], "markers": [], "id": "el3018140537087714320", "ydomain": [-0.013131313131313133, 0.27575757575757576], "collections": [], "xscale": "date", "bbox": [0.125, 0.10999999999999999, 0.775, 0.77]}], "height": 1250.0, "width": 2650.0, "plugins": [{"type": "reset"}, {"enabled": false, "button": true, "type": "zoom"}, {"enabled": false, "button": true, "type": "boxzoom"}, {"alpha_over": 1.0, "element_ids": [["el3018140537087775952", "el3018140537087775952pts"], ["el3018140537085266128", "el3018140537085266128pts"], ["el3018140537085266960", "el3018140537085266960pts"], ["el3018140537085386896", "el3018140537085386896pts"], ["el3018140537085387920", "el3018140537085387920pts"], ["el3018140537085388944", "el3018140537085388944pts"], ["el3018140537085389968", "el3018140537085389968pts"], ["el3018140537085427920", "el3018140537085427920pts"], ["el3018140537085428944", "el3018140537085428944pts"], ["el3018140537085429968", "el3018140537085429968pts"], ["el3018140537085430992", "el3018140537085430992pts"], ["el3018140537084952848", "el3018140537084952848pts"], ["el3018140537084953872", "el3018140537084953872pts"], ["el3018140537084954896", "el3018140537084954896pts"], ["el3018140537084955920", "el3018140537084955920pts"]], "labels": ["Commenting Government", "Relief Efforts", "Commenting Media Coverage", "Commenting Utility", "Well Wishes", "Thanks", "Preparedness", "Status", "Response", "Looting", "Impact", "Other indirect Impact", "Price Gouging", "Requesting Help", "Recovery"], "alpha_unsel": 0.2, "ax": null, "start_visible": [true, true, true, true, true, true, true, true, true, true, true, true, true, true, true], "type": "interactive_legend"}], "data": {"data02": [[736574.0, 0.012315270935960592], [736575.0, 0.003003003003003003], [736576.0, 0.011741682974559686], [736577.0, 0.00909090909090909], [736578.0, 0.002938295788442703], [736579.0, 0.006156552330694811], [736580.0, 0.007547169811320755], [736581.0, 0.006793478260869565], [736582.0, 0.004608294930875576], [736583.0, 0.009615384615384616], [736584.0, 0.013565891472868217], [736585.0, 0.01131687242798354], [736586.0, 0.00620347394540943], [736587.0, 0.016107382550335572], [736588.0, 0.010471204188481676], [736589.0, 0.006042296072507553], [736590.0, 0.01048951048951049], [736591.0, 0.00909090909090909], [736592.0, 0.012578616352201259], [736593.0, 0.0051813471502590676], [736594.0, 0.020089285714285716], [736595.0, 0.0], [736596.0, 0.013574660633484163], [736597.0, 0.007518796992481203], [736598.0, 0.0073937153419593345], [736600.0, 0.011737089201877934], [736601.0, 0.007009345794392523]], "data01": [[736574.0, 0.04187192118226601, 0.07142857142857142, 0.034482758620689655, 0.019704433497536946, 0.08620689655172414, 0.04926108374384237, 0.08374384236453201, 0.08866995073891626, 0.034482758620689655, 0.07635467980295567, 0.06157635467980296, 0.19458128078817735, 0.054187192118226604, 0.054187192118226604], [736575.0, 0.08408408408408409, 0.06006006006006006, 0.012012012012012012, 0.012012012012012012, 0.021021021021021023, 0.05405405405405406, 0.07507507507507508, 0.05405405405405406, 0.03303303303303303, 0.05105105105105105, 0.12312312312312312, 0.2552552552552553, 0.07207207207207207, 0.04504504504504504], [736576.0, 0.04892367906066536, 0.0547945205479452, 0.0136986301369863, 0.0136986301369863, 0.0547945205479452, 0.08610567514677103, 0.1350293542074364, 0.11741682974559686, 0.03913894324853229, 0.04892367906066536, 0.08023483365949119, 0.18003913894324852, 0.06457925636007827, 0.021526418786692758], [736577.0, 0.06233766233766234, 0.05454545454545454, 0.02207792207792208, 0.016883116883116882, 0.03896103896103896, 0.1025974025974026, 0.16753246753246753, 0.13506493506493505, 0.01948051948051948, 0.03116883116883117, 0.05454545454545454, 0.15194805194805194, 0.08701298701298701, 0.02727272727272727], [736578.0, 0.058765915768854066, 0.043095004897159644, 0.015670910871694418, 0.01860920666013712, 0.05778648383937316, 0.10675808031341821, 0.1792360430950049, 0.11655239960822723, 0.03819784524975514, 0.040156709108716944, 0.04603330068560235, 0.13516160626836435, 0.10479921645445642, 0.021547502448579822], [736579.0, 0.06684256816182937, 0.03518029903254178, 0.030782761653474055, 0.012313104661389622, 0.056288478452066845, 0.1424802110817942, 0.16358839050131926, 0.10290237467018469, 0.04309586631486367, 0.05804749340369393, 0.04661389621811785, 0.11433597185576078, 0.09146877748460862, 0.016710642040457344], [736580.0, 0.07245283018867925, 0.040754716981132075, 0.03547169811320755, 0.014339622641509434, 0.05433962264150943, 0.10339622641509434, 0.16905660377358492, 0.11169811320754718, 0.024150943396226414, 0.0649056603773585, 0.052830188679245285, 0.11471698113207547, 0.10339622641509434, 0.019622641509433963], [736581.0, 0.08152173913043478, 0.029891304347826088, 0.057065217391304345, 0.016304347826086956, 0.08695652173913043, 0.09442934782608696, 0.15353260869565216, 0.12839673913043478, 0.03125, 0.06929347826086957, 0.06182065217391304, 0.09103260869565218, 0.07404891304347826, 0.007472826086956522], [736582.0, 0.0724759111855886, 0.026392961876832845, 0.056137410976120655, 0.018852115626309174, 0.09300377042312526, 0.05823209049015501, 0.1822371177209887, 0.11227482195224131, 0.033514872224549644, 0.09300377042312526, 0.05446166736489317, 0.11562630917469627, 0.06158357771260997, 0.011311269375785506], [736583.0, 0.0655048076923077, 0.051682692307692304, 0.026442307692307692, 0.01622596153846154, 0.078125, 0.07151442307692307, 0.12740384615384615, 0.09555288461538461, 0.04567307692307692, 0.11358173076923077, 0.06430288461538461, 0.14903846153846154, 0.05348557692307692, 0.02283653846153846], [736584.0, 0.07170542635658915, 0.06782945736434108, 0.0377906976744186, 0.013565891472868217, 0.06395348837209303, 0.06976744186046512, 0.09205426356589147, 0.08527131782945736, 0.040697674418604654, 0.1124031007751938, 0.0687984496124031, 0.17248062015503876, 0.03972868217054264, 0.035852713178294575], [736585.0, 0.03806584362139918, 0.06378600823045268, 0.01440329218106996, 0.01954732510288066, 0.04526748971193416, 0.07921810699588477, 0.11625514403292181, 0.10185185185185185, 0.037037037037037035, 0.15637860082304528, 0.06481481481481481, 0.17901234567901234, 0.040123456790123455, 0.01748971193415638], [736586.0, 0.05334987593052109, 0.08064516129032258, 0.011166253101736972, 0.0024813895781637717, 0.04466501240694789, 0.11166253101736973, 0.12034739454094293, 0.08312655086848635, 0.03225806451612903, 0.10173697270471464, 0.05955334987593052, 0.20471464019851116, 0.05459057071960298, 0.01488833746898263], [736587.0, 0.05906040268456376, 0.07516778523489932, 0.009395973154362415, 0.013422818791946308, 0.06308724832214765, 0.038926174496644296, 0.11677852348993288, 0.10469798657718121, 0.02953020134228188, 0.0738255033557047, 0.07651006711409396, 0.23624161073825503, 0.042953020134228186, 0.024161073825503355], [736588.0, 0.06282722513089005, 0.04712041884816754, 0.010471204188481676, 0.010471204188481676, 0.0549738219895288, 0.09162303664921466, 0.07329842931937172, 0.05235602094240838, 0.034031413612565446, 0.08115183246073299, 0.12827225130890052, 0.21727748691099477, 0.06544502617801047, 0.020942408376963352], [736589.0, 0.09063444108761329, 0.045317220543806644, 0.02416918429003021, 0.03625377643504532, 0.04229607250755287, 0.045317220543806644, 0.06948640483383686, 0.08459214501510574, 0.04229607250755287, 0.10574018126888217, 0.07250755287009064, 0.21450151057401812, 0.0634441087613293, 0.012084592145015106], [736590.0, 0.06993006993006994, 0.04020979020979021, 0.024475524475524476, 0.0472027972027972, 0.05944055944055944, 0.038461538461538464, 0.09965034965034965, 0.08216783216783216, 0.012237762237762238, 0.08916083916083917, 0.08391608391608392, 0.22727272727272727, 0.07867132867132867, 0.01048951048951049], [736591.0, 0.05909090909090909, 0.04696969696969697, 0.01818181818181818, 0.03636363636363636, 0.05606060606060606, 0.031818181818181815, 0.11515151515151516, 0.09545454545454546, 0.02878787878787879, 0.11363636363636363, 0.08787878787878788, 0.19090909090909092, 0.07272727272727272, 0.015151515151515152], [736592.0, 0.055031446540880505, 0.05345911949685535, 0.036163522012578615, 0.05817610062893082, 0.055031446540880505, 0.01729559748427673, 0.10062893081761007, 0.09433962264150944, 0.018867924528301886, 0.0770440251572327, 0.0959119496855346, 0.21069182389937108, 0.07547169811320754, 0.015723270440251572], [736593.0, 0.03281519861830743, 0.07081174438687392, 0.022452504317789293, 0.04835924006908463, 0.06390328151986183, 0.03626943005181347, 0.08635578583765112, 0.07599309153713299, 0.03281519861830743, 0.09153713298791019, 0.10880829015544041, 0.20379965457685664, 0.06735751295336788, 0.027633851468048358], [736594.0, 0.05357142857142857, 0.060267857142857144, 0.008928571428571428, 0.03794642857142857, 0.05133928571428571, 0.046875, 0.09598214285714286, 0.046875, 0.017857142857142856, 0.10044642857142858, 0.10714285714285714, 0.234375, 0.05803571428571429, 0.026785714285714284], [736595.0, 0.05723905723905724, 0.05723905723905724, 0.03367003367003367, 0.037037037037037035, 0.08417508417508418, 0.037037037037037035, 0.10774410774410774, 0.050505050505050504, 0.016835016835016835, 0.04377104377104377, 0.09764309764309764, 0.26262626262626265, 0.04713804713804714, 0.016835016835016835], [736596.0, 0.049773755656108594, 0.03167420814479638, 0.01809954751131222, 0.02262443438914027, 0.06787330316742081, 0.06787330316742081, 0.09954751131221719, 0.05429864253393665, 0.013574660633484163, 0.07239819004524888, 0.09954751131221719, 0.2398190045248869, 0.03167420814479638, 0.049773755656108594], [736597.0, 0.05513784461152882, 0.07268170426065163, 0.047619047619047616, 0.022556390977443608, 0.03759398496240601, 0.042606516290726815, 0.11528822055137844, 0.09273182957393483, 0.03258145363408521, 0.09273182957393483, 0.07017543859649122, 0.20300751879699247, 0.05513784461152882, 0.015037593984962405], [736598.0, 0.06839186691312385, 0.04251386321626617, 0.014787430683918669, 0.029574861367837338, 0.07024029574861368, 0.033271719038817, 0.08502772643253234, 0.08317929759704251, 0.025878003696857672, 0.10166358595194085, 0.09796672828096119, 0.23475046210720887, 0.051756007393715345, 0.025878003696857672], [736599.0, 0.040339702760084924, 0.07855626326963906, 0.010615711252653927, 0.025477707006369428, 0.06157112526539278, 0.055201698513800426, 0.08280254777070063, 0.08917197452229299, 0.03397027600849257, 0.07430997876857749, 0.05732484076433121, 0.25477707006369427, 0.07430997876857749, 0.03184713375796178], [736600.0, 0.10328638497652583, 0.07746478873239436, 0.011737089201877934, 0.023474178403755867, 0.03051643192488263, 0.035211267605633804, 0.07042253521126761, 0.08685446009389672, 0.018779342723004695, 0.09624413145539906, 0.08685446009389672, 0.23943661971830985, 0.051643192488262914, 0.02112676056338028], [736601.0, 0.08878504672897196, 0.053738317757009345, 0.02570093457943925, 0.03271028037383177, 0.053738317757009345, 0.035046728971962614, 0.10981308411214953, 0.08878504672897196, 0.016355140186915886, 0.08177570093457943, 0.08644859813084112, 0.22429906542056074, 0.037383177570093455, 0.02336448598130841]]}, "id": "el3018140537104096848"});
   }(mpld3);
}else if(typeof define === "function" && define.amd){
   // require.js is available: use it to load d3/mpld3
   require.config({paths: {d3: "https://mpld3.github.io/js/d3.v3.min"}});
   require(["d3"], function(d3){
      window.d3 = d3;
      mpld3_load_lib("https://mpld3.github.io/js/mpld3.v0.3.js", function(){
         
    mpld3.register_plugin("interactive_legend", InteractiveLegend);
    InteractiveLegend.prototype = Object.create(mpld3.Plugin.prototype);
    InteractiveLegend.prototype.constructor = InteractiveLegend;
    InteractiveLegend.prototype.requiredProps = ["element_ids", "labels"];
    InteractiveLegend.prototype.defaultProps = {"ax":null,
                                                "alpha_unsel":0.2,
                                                "alpha_over":1.0,
                                                "start_visible":true}
    function InteractiveLegend(fig, props){
        mpld3.Plugin.call(this, fig, props);
    };

    InteractiveLegend.prototype.draw = function(){
        var alpha_unsel = this.props.alpha_unsel;
        var alpha_over = this.props.alpha_over;

        var legendItems = new Array();
        for(var i=0; i<this.props.labels.length; i++){
            var obj = {};
            obj.label = this.props.labels[i];

            var element_id = this.props.element_ids[i];
            mpld3_elements = [];
            for(var j=0; j<element_id.length; j++){
                var mpld3_element = mpld3.get_element(element_id[j], this.fig);

                // mpld3_element might be null in case of Line2D instances
                // for we pass the id for both the line and the markers. Either
                // one might not exist on the D3 side
                if(mpld3_element){
                    mpld3_elements.push(mpld3_element);
                }
            }

            obj.mpld3_elements = mpld3_elements;
            obj.visible = this.props.start_visible[i]; // should become be setable from python side
            legendItems.push(obj);
            set_alphas(obj, false);
        }

        // determine the axes with which this legend is associated
        var ax = this.props.ax
        if(!ax){
            ax = this.fig.axes[0];
        } else{
            ax = mpld3.get_element(ax, this.fig);
        }

        // add a legend group to the canvas of the figure
        var legend = this.fig.canvas.append("svg:g")
                               .attr("class", "legend");

        // add the rectangles
        legend.selectAll("rect")
                .data(legendItems)
                .enter().append("rect")
                .attr("height", 10)
                .attr("width", 25)
                .attr("x", ax.width + ax.position[0] + 25)
                .attr("y",function(d,i) {
                           return ax.position[1] + i * 25 + 10;})
                .attr("stroke", get_color)
                .attr("class", "legend-box")
                .style("fill", function(d, i) {
                           return d.visible ? get_color(d) : "white";})
                .on("click", click).on('mouseover', over).on('mouseout', out);

        // add the labels
        legend.selectAll("text")
              .data(legendItems)
              .enter().append("text")
              .attr("x", function (d) {
                           return ax.width + ax.position[0] + 25 + 40;})
              .attr("y", function(d,i) {
                           return ax.position[1] + i * 25 + 10 + 10 - 1;})
              .text(function(d) { return d.label });


        // specify the action on click
        function click(d,i){
            d.visible = !d.visible;
            d3.select(this)
              .style("fill",function(d, i) {
                return d.visible ? get_color(d) : "white";
              })
            set_alphas(d, false);

        };

        // specify the action on legend overlay 
        function over(d,i){
             set_alphas(d, true);
        };

        // specify the action on legend overlay 
        function out(d,i){
             set_alphas(d, false);
        };

        // helper function for setting alphas
        function set_alphas(d, is_over){
            for(var i=0; i<d.mpld3_elements.length; i++){
                var type = d.mpld3_elements[i].constructor.name;

                if(type =="mpld3_Line"){
                    var current_alpha = d.mpld3_elements[i].props.alpha;
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.select(d.mpld3_elements[i].path[0][0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("stroke-width", is_over ? 
                                alpha_over * d.mpld3_elements[i].props.edgewidth : d.mpld3_elements[i].props.edgewidth);
                } else if((type=="mpld3_PathCollection")||
                         (type=="mpld3_Markers")){
                    var current_alpha = d.mpld3_elements[i].props.alphas[0];
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.selectAll(d.mpld3_elements[i].pathsobj[0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("fill-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel));
                } else{
                    console.log(type + " not yet supported");
                }
            }
        };


        // helper function for determining the color of the rectangles
        function get_color(d){
            var type = d.mpld3_elements[0].constructor.name;
            var color = "black";
            if(type =="mpld3_Line"){
                color = d.mpld3_elements[0].props.edgecolor;
            } else if((type=="mpld3_PathCollection")||
                      (type=="mpld3_Markers")){
                color = d.mpld3_elements[0].props.facecolors[0];
            } else{
                console.log(type + " not yet supported");
            }
            return color;
        };
    };
    
         mpld3.draw_figure("fig_el30181405371040968486259833367", {"axes": [{"xlim": [736572.65, 736602.35], "yscale": "linear", "axesbg": "#FFFFFF", "texts": [{"v_baseline": "hanging", "h_anchor": "middle", "color": "#000000", "text": "Time", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [0.5, -0.030418470418470414], "rotation": -0.0, "id": "el3018140537087717008"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Number of Tweets Per Day", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [-0.022411577737201593, 0.5], "rotation": -90.0, "id": "el3018140537087775504"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Topics Distribution During Hurricane Irma (Random Forest) (media_percentage)", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 12.0, "position": [0.5, 1.0086580086580086], "rotation": -0.0, "id": "el3018140537087815056"}], "zoomable": true, "images": [], "xdomain": [[2017, 7, 31, 15, 36, 0, 0.0], [2017, 8, 30, 8, 24, 0, 0.0]], "ylim": [-0.013131313131313133, 0.27575757575757576], "paths": [], "sharey": [], "sharex": [], "axesbgalpha": null, "axes": [{"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "bottom", "nticks": 10, "tickvalues": null}, {"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "left", "nticks": 8, "tickvalues": null}], "lines": [{"drawstyle": "default", "color": "#1F77B4", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537087775952"}, {"drawstyle": "default", "color": "#AEC7E8", "yindex": 2, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085266128"}, {"drawstyle": "default", "color": "#FF7F0E", "yindex": 3, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085266960"}, {"drawstyle": "default", "color": "#2CA02C", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data02", "id": "el3018140537085386896"}, {"drawstyle": "default", "color": "#98DF8A", "yindex": 4, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085387920"}, {"drawstyle": "default", "color": "#D62728", "yindex": 5, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085388944"}, {"drawstyle": "default", "color": "#9467BD", "yindex": 6, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085389968"}, {"drawstyle": "default", "color": "#C5B0D5", "yindex": 7, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085427920"}, {"drawstyle": "default", "color": "#8C564B", "yindex": 8, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085428944"}, {"drawstyle": "default", "color": "#E377C2", "yindex": 9, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085429968"}, {"drawstyle": "default", "color": "#F7B6D2", "yindex": 10, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085430992"}, {"drawstyle": "default", "color": "#7F7F7F", "yindex": 11, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084952848"}, {"drawstyle": "default", "color": "#BCBD22", "yindex": 12, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084953872"}, {"drawstyle": "default", "color": "#DBDB8D", "yindex": 13, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084954896"}, {"drawstyle": "default", "color": "#17BECF", "yindex": 14, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084955920"}], "markers": [], "id": "el3018140537087714320", "ydomain": [-0.013131313131313133, 0.27575757575757576], "collections": [], "xscale": "date", "bbox": [0.125, 0.10999999999999999, 0.775, 0.77]}], "height": 1250.0, "width": 2650.0, "plugins": [{"type": "reset"}, {"enabled": false, "button": true, "type": "zoom"}, {"enabled": false, "button": true, "type": "boxzoom"}, {"alpha_over": 1.0, "element_ids": [["el3018140537087775952", "el3018140537087775952pts"], ["el3018140537085266128", "el3018140537085266128pts"], ["el3018140537085266960", "el3018140537085266960pts"], ["el3018140537085386896", "el3018140537085386896pts"], ["el3018140537085387920", "el3018140537085387920pts"], ["el3018140537085388944", "el3018140537085388944pts"], ["el3018140537085389968", "el3018140537085389968pts"], ["el3018140537085427920", "el3018140537085427920pts"], ["el3018140537085428944", "el3018140537085428944pts"], ["el3018140537085429968", "el3018140537085429968pts"], ["el3018140537085430992", "el3018140537085430992pts"], ["el3018140537084952848", "el3018140537084952848pts"], ["el3018140537084953872", "el3018140537084953872pts"], ["el3018140537084954896", "el3018140537084954896pts"], ["el3018140537084955920", "el3018140537084955920pts"]], "labels": ["Commenting Government", "Relief Efforts", "Commenting Media Coverage", "Commenting Utility", "Well Wishes", "Thanks", "Preparedness", "Status", "Response", "Looting", "Impact", "Other indirect Impact", "Price Gouging", "Requesting Help", "Recovery"], "alpha_unsel": 0.2, "ax": null, "start_visible": [true, true, true, true, true, true, true, true, true, true, true, true, true, true, true], "type": "interactive_legend"}], "data": {"data02": [[736574.0, 0.012315270935960592], [736575.0, 0.003003003003003003], [736576.0, 0.011741682974559686], [736577.0, 0.00909090909090909], [736578.0, 0.002938295788442703], [736579.0, 0.006156552330694811], [736580.0, 0.007547169811320755], [736581.0, 0.006793478260869565], [736582.0, 0.004608294930875576], [736583.0, 0.009615384615384616], [736584.0, 0.013565891472868217], [736585.0, 0.01131687242798354], [736586.0, 0.00620347394540943], [736587.0, 0.016107382550335572], [736588.0, 0.010471204188481676], [736589.0, 0.006042296072507553], [736590.0, 0.01048951048951049], [736591.0, 0.00909090909090909], [736592.0, 0.012578616352201259], [736593.0, 0.0051813471502590676], [736594.0, 0.020089285714285716], [736595.0, 0.0], [736596.0, 0.013574660633484163], [736597.0, 0.007518796992481203], [736598.0, 0.0073937153419593345], [736600.0, 0.011737089201877934], [736601.0, 0.007009345794392523]], "data01": [[736574.0, 0.04187192118226601, 0.07142857142857142, 0.034482758620689655, 0.019704433497536946, 0.08620689655172414, 0.04926108374384237, 0.08374384236453201, 0.08866995073891626, 0.034482758620689655, 0.07635467980295567, 0.06157635467980296, 0.19458128078817735, 0.054187192118226604, 0.054187192118226604], [736575.0, 0.08408408408408409, 0.06006006006006006, 0.012012012012012012, 0.012012012012012012, 0.021021021021021023, 0.05405405405405406, 0.07507507507507508, 0.05405405405405406, 0.03303303303303303, 0.05105105105105105, 0.12312312312312312, 0.2552552552552553, 0.07207207207207207, 0.04504504504504504], [736576.0, 0.04892367906066536, 0.0547945205479452, 0.0136986301369863, 0.0136986301369863, 0.0547945205479452, 0.08610567514677103, 0.1350293542074364, 0.11741682974559686, 0.03913894324853229, 0.04892367906066536, 0.08023483365949119, 0.18003913894324852, 0.06457925636007827, 0.021526418786692758], [736577.0, 0.06233766233766234, 0.05454545454545454, 0.02207792207792208, 0.016883116883116882, 0.03896103896103896, 0.1025974025974026, 0.16753246753246753, 0.13506493506493505, 0.01948051948051948, 0.03116883116883117, 0.05454545454545454, 0.15194805194805194, 0.08701298701298701, 0.02727272727272727], [736578.0, 0.058765915768854066, 0.043095004897159644, 0.015670910871694418, 0.01860920666013712, 0.05778648383937316, 0.10675808031341821, 0.1792360430950049, 0.11655239960822723, 0.03819784524975514, 0.040156709108716944, 0.04603330068560235, 0.13516160626836435, 0.10479921645445642, 0.021547502448579822], [736579.0, 0.06684256816182937, 0.03518029903254178, 0.030782761653474055, 0.012313104661389622, 0.056288478452066845, 0.1424802110817942, 0.16358839050131926, 0.10290237467018469, 0.04309586631486367, 0.05804749340369393, 0.04661389621811785, 0.11433597185576078, 0.09146877748460862, 0.016710642040457344], [736580.0, 0.07245283018867925, 0.040754716981132075, 0.03547169811320755, 0.014339622641509434, 0.05433962264150943, 0.10339622641509434, 0.16905660377358492, 0.11169811320754718, 0.024150943396226414, 0.0649056603773585, 0.052830188679245285, 0.11471698113207547, 0.10339622641509434, 0.019622641509433963], [736581.0, 0.08152173913043478, 0.029891304347826088, 0.057065217391304345, 0.016304347826086956, 0.08695652173913043, 0.09442934782608696, 0.15353260869565216, 0.12839673913043478, 0.03125, 0.06929347826086957, 0.06182065217391304, 0.09103260869565218, 0.07404891304347826, 0.007472826086956522], [736582.0, 0.0724759111855886, 0.026392961876832845, 0.056137410976120655, 0.018852115626309174, 0.09300377042312526, 0.05823209049015501, 0.1822371177209887, 0.11227482195224131, 0.033514872224549644, 0.09300377042312526, 0.05446166736489317, 0.11562630917469627, 0.06158357771260997, 0.011311269375785506], [736583.0, 0.0655048076923077, 0.051682692307692304, 0.026442307692307692, 0.01622596153846154, 0.078125, 0.07151442307692307, 0.12740384615384615, 0.09555288461538461, 0.04567307692307692, 0.11358173076923077, 0.06430288461538461, 0.14903846153846154, 0.05348557692307692, 0.02283653846153846], [736584.0, 0.07170542635658915, 0.06782945736434108, 0.0377906976744186, 0.013565891472868217, 0.06395348837209303, 0.06976744186046512, 0.09205426356589147, 0.08527131782945736, 0.040697674418604654, 0.1124031007751938, 0.0687984496124031, 0.17248062015503876, 0.03972868217054264, 0.035852713178294575], [736585.0, 0.03806584362139918, 0.06378600823045268, 0.01440329218106996, 0.01954732510288066, 0.04526748971193416, 0.07921810699588477, 0.11625514403292181, 0.10185185185185185, 0.037037037037037035, 0.15637860082304528, 0.06481481481481481, 0.17901234567901234, 0.040123456790123455, 0.01748971193415638], [736586.0, 0.05334987593052109, 0.08064516129032258, 0.011166253101736972, 0.0024813895781637717, 0.04466501240694789, 0.11166253101736973, 0.12034739454094293, 0.08312655086848635, 0.03225806451612903, 0.10173697270471464, 0.05955334987593052, 0.20471464019851116, 0.05459057071960298, 0.01488833746898263], [736587.0, 0.05906040268456376, 0.07516778523489932, 0.009395973154362415, 0.013422818791946308, 0.06308724832214765, 0.038926174496644296, 0.11677852348993288, 0.10469798657718121, 0.02953020134228188, 0.0738255033557047, 0.07651006711409396, 0.23624161073825503, 0.042953020134228186, 0.024161073825503355], [736588.0, 0.06282722513089005, 0.04712041884816754, 0.010471204188481676, 0.010471204188481676, 0.0549738219895288, 0.09162303664921466, 0.07329842931937172, 0.05235602094240838, 0.034031413612565446, 0.08115183246073299, 0.12827225130890052, 0.21727748691099477, 0.06544502617801047, 0.020942408376963352], [736589.0, 0.09063444108761329, 0.045317220543806644, 0.02416918429003021, 0.03625377643504532, 0.04229607250755287, 0.045317220543806644, 0.06948640483383686, 0.08459214501510574, 0.04229607250755287, 0.10574018126888217, 0.07250755287009064, 0.21450151057401812, 0.0634441087613293, 0.012084592145015106], [736590.0, 0.06993006993006994, 0.04020979020979021, 0.024475524475524476, 0.0472027972027972, 0.05944055944055944, 0.038461538461538464, 0.09965034965034965, 0.08216783216783216, 0.012237762237762238, 0.08916083916083917, 0.08391608391608392, 0.22727272727272727, 0.07867132867132867, 0.01048951048951049], [736591.0, 0.05909090909090909, 0.04696969696969697, 0.01818181818181818, 0.03636363636363636, 0.05606060606060606, 0.031818181818181815, 0.11515151515151516, 0.09545454545454546, 0.02878787878787879, 0.11363636363636363, 0.08787878787878788, 0.19090909090909092, 0.07272727272727272, 0.015151515151515152], [736592.0, 0.055031446540880505, 0.05345911949685535, 0.036163522012578615, 0.05817610062893082, 0.055031446540880505, 0.01729559748427673, 0.10062893081761007, 0.09433962264150944, 0.018867924528301886, 0.0770440251572327, 0.0959119496855346, 0.21069182389937108, 0.07547169811320754, 0.015723270440251572], [736593.0, 0.03281519861830743, 0.07081174438687392, 0.022452504317789293, 0.04835924006908463, 0.06390328151986183, 0.03626943005181347, 0.08635578583765112, 0.07599309153713299, 0.03281519861830743, 0.09153713298791019, 0.10880829015544041, 0.20379965457685664, 0.06735751295336788, 0.027633851468048358], [736594.0, 0.05357142857142857, 0.060267857142857144, 0.008928571428571428, 0.03794642857142857, 0.05133928571428571, 0.046875, 0.09598214285714286, 0.046875, 0.017857142857142856, 0.10044642857142858, 0.10714285714285714, 0.234375, 0.05803571428571429, 0.026785714285714284], [736595.0, 0.05723905723905724, 0.05723905723905724, 0.03367003367003367, 0.037037037037037035, 0.08417508417508418, 0.037037037037037035, 0.10774410774410774, 0.050505050505050504, 0.016835016835016835, 0.04377104377104377, 0.09764309764309764, 0.26262626262626265, 0.04713804713804714, 0.016835016835016835], [736596.0, 0.049773755656108594, 0.03167420814479638, 0.01809954751131222, 0.02262443438914027, 0.06787330316742081, 0.06787330316742081, 0.09954751131221719, 0.05429864253393665, 0.013574660633484163, 0.07239819004524888, 0.09954751131221719, 0.2398190045248869, 0.03167420814479638, 0.049773755656108594], [736597.0, 0.05513784461152882, 0.07268170426065163, 0.047619047619047616, 0.022556390977443608, 0.03759398496240601, 0.042606516290726815, 0.11528822055137844, 0.09273182957393483, 0.03258145363408521, 0.09273182957393483, 0.07017543859649122, 0.20300751879699247, 0.05513784461152882, 0.015037593984962405], [736598.0, 0.06839186691312385, 0.04251386321626617, 0.014787430683918669, 0.029574861367837338, 0.07024029574861368, 0.033271719038817, 0.08502772643253234, 0.08317929759704251, 0.025878003696857672, 0.10166358595194085, 0.09796672828096119, 0.23475046210720887, 0.051756007393715345, 0.025878003696857672], [736599.0, 0.040339702760084924, 0.07855626326963906, 0.010615711252653927, 0.025477707006369428, 0.06157112526539278, 0.055201698513800426, 0.08280254777070063, 0.08917197452229299, 0.03397027600849257, 0.07430997876857749, 0.05732484076433121, 0.25477707006369427, 0.07430997876857749, 0.03184713375796178], [736600.0, 0.10328638497652583, 0.07746478873239436, 0.011737089201877934, 0.023474178403755867, 0.03051643192488263, 0.035211267605633804, 0.07042253521126761, 0.08685446009389672, 0.018779342723004695, 0.09624413145539906, 0.08685446009389672, 0.23943661971830985, 0.051643192488262914, 0.02112676056338028], [736601.0, 0.08878504672897196, 0.053738317757009345, 0.02570093457943925, 0.03271028037383177, 0.053738317757009345, 0.035046728971962614, 0.10981308411214953, 0.08878504672897196, 0.016355140186915886, 0.08177570093457943, 0.08644859813084112, 0.22429906542056074, 0.037383177570093455, 0.02336448598130841]]}, "id": "el3018140537104096848"});
      });
    });
}else{
    // require.js not available: dynamically load d3 & mpld3
    mpld3_load_lib("https://mpld3.github.io/js/d3.v3.min.js", function(){
         mpld3_load_lib("https://mpld3.github.io/js/mpld3.v0.3.js", function(){
                 
    mpld3.register_plugin("interactive_legend", InteractiveLegend);
    InteractiveLegend.prototype = Object.create(mpld3.Plugin.prototype);
    InteractiveLegend.prototype.constructor = InteractiveLegend;
    InteractiveLegend.prototype.requiredProps = ["element_ids", "labels"];
    InteractiveLegend.prototype.defaultProps = {"ax":null,
                                                "alpha_unsel":0.2,
                                                "alpha_over":1.0,
                                                "start_visible":true}
    function InteractiveLegend(fig, props){
        mpld3.Plugin.call(this, fig, props);
    };

    InteractiveLegend.prototype.draw = function(){
        var alpha_unsel = this.props.alpha_unsel;
        var alpha_over = this.props.alpha_over;

        var legendItems = new Array();
        for(var i=0; i<this.props.labels.length; i++){
            var obj = {};
            obj.label = this.props.labels[i];

            var element_id = this.props.element_ids[i];
            mpld3_elements = [];
            for(var j=0; j<element_id.length; j++){
                var mpld3_element = mpld3.get_element(element_id[j], this.fig);

                // mpld3_element might be null in case of Line2D instances
                // for we pass the id for both the line and the markers. Either
                // one might not exist on the D3 side
                if(mpld3_element){
                    mpld3_elements.push(mpld3_element);
                }
            }

            obj.mpld3_elements = mpld3_elements;
            obj.visible = this.props.start_visible[i]; // should become be setable from python side
            legendItems.push(obj);
            set_alphas(obj, false);
        }

        // determine the axes with which this legend is associated
        var ax = this.props.ax
        if(!ax){
            ax = this.fig.axes[0];
        } else{
            ax = mpld3.get_element(ax, this.fig);
        }

        // add a legend group to the canvas of the figure
        var legend = this.fig.canvas.append("svg:g")
                               .attr("class", "legend");

        // add the rectangles
        legend.selectAll("rect")
                .data(legendItems)
                .enter().append("rect")
                .attr("height", 10)
                .attr("width", 25)
                .attr("x", ax.width + ax.position[0] + 25)
                .attr("y",function(d,i) {
                           return ax.position[1] + i * 25 + 10;})
                .attr("stroke", get_color)
                .attr("class", "legend-box")
                .style("fill", function(d, i) {
                           return d.visible ? get_color(d) : "white";})
                .on("click", click).on('mouseover', over).on('mouseout', out);

        // add the labels
        legend.selectAll("text")
              .data(legendItems)
              .enter().append("text")
              .attr("x", function (d) {
                           return ax.width + ax.position[0] + 25 + 40;})
              .attr("y", function(d,i) {
                           return ax.position[1] + i * 25 + 10 + 10 - 1;})
              .text(function(d) { return d.label });


        // specify the action on click
        function click(d,i){
            d.visible = !d.visible;
            d3.select(this)
              .style("fill",function(d, i) {
                return d.visible ? get_color(d) : "white";
              })
            set_alphas(d, false);

        };

        // specify the action on legend overlay 
        function over(d,i){
             set_alphas(d, true);
        };

        // specify the action on legend overlay 
        function out(d,i){
             set_alphas(d, false);
        };

        // helper function for setting alphas
        function set_alphas(d, is_over){
            for(var i=0; i<d.mpld3_elements.length; i++){
                var type = d.mpld3_elements[i].constructor.name;

                if(type =="mpld3_Line"){
                    var current_alpha = d.mpld3_elements[i].props.alpha;
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.select(d.mpld3_elements[i].path[0][0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("stroke-width", is_over ? 
                                alpha_over * d.mpld3_elements[i].props.edgewidth : d.mpld3_elements[i].props.edgewidth);
                } else if((type=="mpld3_PathCollection")||
                         (type=="mpld3_Markers")){
                    var current_alpha = d.mpld3_elements[i].props.alphas[0];
                    var current_alpha_unsel = current_alpha * alpha_unsel;
                    var current_alpha_over = current_alpha * alpha_over;
                    d3.selectAll(d.mpld3_elements[i].pathsobj[0])
                        .style("stroke-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel))
                        .style("fill-opacity", is_over ? current_alpha_over :
                                                (d.visible ? current_alpha : current_alpha_unsel));
                } else{
                    console.log(type + " not yet supported");
                }
            }
        };


        // helper function for determining the color of the rectangles
        function get_color(d){
            var type = d.mpld3_elements[0].constructor.name;
            var color = "black";
            if(type =="mpld3_Line"){
                color = d.mpld3_elements[0].props.edgecolor;
            } else if((type=="mpld3_PathCollection")||
                      (type=="mpld3_Markers")){
                color = d.mpld3_elements[0].props.facecolors[0];
            } else{
                console.log(type + " not yet supported");
            }
            return color;
        };
    };
    
                 mpld3.draw_figure("fig_el30181405371040968486259833367", {"axes": [{"xlim": [736572.65, 736602.35], "yscale": "linear", "axesbg": "#FFFFFF", "texts": [{"v_baseline": "hanging", "h_anchor": "middle", "color": "#000000", "text": "Time", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [0.5, -0.030418470418470414], "rotation": -0.0, "id": "el3018140537087717008"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Number of Tweets Per Day", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 10.0, "position": [-0.022411577737201593, 0.5], "rotation": -90.0, "id": "el3018140537087775504"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Topics Distribution During Hurricane Irma (Random Forest) (media_percentage)", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 12.0, "position": [0.5, 1.0086580086580086], "rotation": -0.0, "id": "el3018140537087815056"}], "zoomable": true, "images": [], "xdomain": [[2017, 7, 31, 15, 36, 0, 0.0], [2017, 8, 30, 8, 24, 0, 0.0]], "ylim": [-0.013131313131313133, 0.27575757575757576], "paths": [], "sharey": [], "sharex": [], "axesbgalpha": null, "axes": [{"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "bottom", "nticks": 10, "tickvalues": null}, {"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "visible": true, "fontsize": 10.0, "position": "left", "nticks": 8, "tickvalues": null}], "lines": [{"drawstyle": "default", "color": "#1F77B4", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537087775952"}, {"drawstyle": "default", "color": "#AEC7E8", "yindex": 2, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085266128"}, {"drawstyle": "default", "color": "#FF7F0E", "yindex": 3, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085266960"}, {"drawstyle": "default", "color": "#2CA02C", "yindex": 1, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data02", "id": "el3018140537085386896"}, {"drawstyle": "default", "color": "#98DF8A", "yindex": 4, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085387920"}, {"drawstyle": "default", "color": "#D62728", "yindex": 5, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085388944"}, {"drawstyle": "default", "color": "#9467BD", "yindex": 6, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085389968"}, {"drawstyle": "default", "color": "#C5B0D5", "yindex": 7, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085427920"}, {"drawstyle": "default", "color": "#8C564B", "yindex": 8, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085428944"}, {"drawstyle": "default", "color": "#E377C2", "yindex": 9, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085429968"}, {"drawstyle": "default", "color": "#F7B6D2", "yindex": 10, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537085430992"}, {"drawstyle": "default", "color": "#7F7F7F", "yindex": 11, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084952848"}, {"drawstyle": "default", "color": "#BCBD22", "yindex": 12, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084953872"}, {"drawstyle": "default", "color": "#DBDB8D", "yindex": 13, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084954896"}, {"drawstyle": "default", "color": "#17BECF", "yindex": 14, "coordinates": "data", "dasharray": "none", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el3018140537084955920"}], "markers": [], "id": "el3018140537087714320", "ydomain": [-0.013131313131313133, 0.27575757575757576], "collections": [], "xscale": "date", "bbox": [0.125, 0.10999999999999999, 0.775, 0.77]}], "height": 1250.0, "width": 2650.0, "plugins": [{"type": "reset"}, {"enabled": false, "button": true, "type": "zoom"}, {"enabled": false, "button": true, "type": "boxzoom"}, {"alpha_over": 1.0, "element_ids": [["el3018140537087775952", "el3018140537087775952pts"], ["el3018140537085266128", "el3018140537085266128pts"], ["el3018140537085266960", "el3018140537085266960pts"], ["el3018140537085386896", "el3018140537085386896pts"], ["el3018140537085387920", "el3018140537085387920pts"], ["el3018140537085388944", "el3018140537085388944pts"], ["el3018140537085389968", "el3018140537085389968pts"], ["el3018140537085427920", "el3018140537085427920pts"], ["el3018140537085428944", "el3018140537085428944pts"], ["el3018140537085429968", "el3018140537085429968pts"], ["el3018140537085430992", "el3018140537085430992pts"], ["el3018140537084952848", "el3018140537084952848pts"], ["el3018140537084953872", "el3018140537084953872pts"], ["el3018140537084954896", "el3018140537084954896pts"], ["el3018140537084955920", "el3018140537084955920pts"]], "labels": ["Commenting Government", "Relief Efforts", "Commenting Media Coverage", "Commenting Utility", "Well Wishes", "Thanks", "Preparedness", "Status", "Response", "Looting", "Impact", "Other indirect Impact", "Price Gouging", "Requesting Help", "Recovery"], "alpha_unsel": 0.2, "ax": null, "start_visible": [true, true, true, true, true, true, true, true, true, true, true, true, true, true, true], "type": "interactive_legend"}], "data": {"data02": [[736574.0, 0.012315270935960592], [736575.0, 0.003003003003003003], [736576.0, 0.011741682974559686], [736577.0, 0.00909090909090909], [736578.0, 0.002938295788442703], [736579.0, 0.006156552330694811], [736580.0, 0.007547169811320755], [736581.0, 0.006793478260869565], [736582.0, 0.004608294930875576], [736583.0, 0.009615384615384616], [736584.0, 0.013565891472868217], [736585.0, 0.01131687242798354], [736586.0, 0.00620347394540943], [736587.0, 0.016107382550335572], [736588.0, 0.010471204188481676], [736589.0, 0.006042296072507553], [736590.0, 0.01048951048951049], [736591.0, 0.00909090909090909], [736592.0, 0.012578616352201259], [736593.0, 0.0051813471502590676], [736594.0, 0.020089285714285716], [736595.0, 0.0], [736596.0, 0.013574660633484163], [736597.0, 0.007518796992481203], [736598.0, 0.0073937153419593345], [736600.0, 0.011737089201877934], [736601.0, 0.007009345794392523]], "data01": [[736574.0, 0.04187192118226601, 0.07142857142857142, 0.034482758620689655, 0.019704433497536946, 0.08620689655172414, 0.04926108374384237, 0.08374384236453201, 0.08866995073891626, 0.034482758620689655, 0.07635467980295567, 0.06157635467980296, 0.19458128078817735, 0.054187192118226604, 0.054187192118226604], [736575.0, 0.08408408408408409, 0.06006006006006006, 0.012012012012012012, 0.012012012012012012, 0.021021021021021023, 0.05405405405405406, 0.07507507507507508, 0.05405405405405406, 0.03303303303303303, 0.05105105105105105, 0.12312312312312312, 0.2552552552552553, 0.07207207207207207, 0.04504504504504504], [736576.0, 0.04892367906066536, 0.0547945205479452, 0.0136986301369863, 0.0136986301369863, 0.0547945205479452, 0.08610567514677103, 0.1350293542074364, 0.11741682974559686, 0.03913894324853229, 0.04892367906066536, 0.08023483365949119, 0.18003913894324852, 0.06457925636007827, 0.021526418786692758], [736577.0, 0.06233766233766234, 0.05454545454545454, 0.02207792207792208, 0.016883116883116882, 0.03896103896103896, 0.1025974025974026, 0.16753246753246753, 0.13506493506493505, 0.01948051948051948, 0.03116883116883117, 0.05454545454545454, 0.15194805194805194, 0.08701298701298701, 0.02727272727272727], [736578.0, 0.058765915768854066, 0.043095004897159644, 0.015670910871694418, 0.01860920666013712, 0.05778648383937316, 0.10675808031341821, 0.1792360430950049, 0.11655239960822723, 0.03819784524975514, 0.040156709108716944, 0.04603330068560235, 0.13516160626836435, 0.10479921645445642, 0.021547502448579822], [736579.0, 0.06684256816182937, 0.03518029903254178, 0.030782761653474055, 0.012313104661389622, 0.056288478452066845, 0.1424802110817942, 0.16358839050131926, 0.10290237467018469, 0.04309586631486367, 0.05804749340369393, 0.04661389621811785, 0.11433597185576078, 0.09146877748460862, 0.016710642040457344], [736580.0, 0.07245283018867925, 0.040754716981132075, 0.03547169811320755, 0.014339622641509434, 0.05433962264150943, 0.10339622641509434, 0.16905660377358492, 0.11169811320754718, 0.024150943396226414, 0.0649056603773585, 0.052830188679245285, 0.11471698113207547, 0.10339622641509434, 0.019622641509433963], [736581.0, 0.08152173913043478, 0.029891304347826088, 0.057065217391304345, 0.016304347826086956, 0.08695652173913043, 0.09442934782608696, 0.15353260869565216, 0.12839673913043478, 0.03125, 0.06929347826086957, 0.06182065217391304, 0.09103260869565218, 0.07404891304347826, 0.007472826086956522], [736582.0, 0.0724759111855886, 0.026392961876832845, 0.056137410976120655, 0.018852115626309174, 0.09300377042312526, 0.05823209049015501, 0.1822371177209887, 0.11227482195224131, 0.033514872224549644, 0.09300377042312526, 0.05446166736489317, 0.11562630917469627, 0.06158357771260997, 0.011311269375785506], [736583.0, 0.0655048076923077, 0.051682692307692304, 0.026442307692307692, 0.01622596153846154, 0.078125, 0.07151442307692307, 0.12740384615384615, 0.09555288461538461, 0.04567307692307692, 0.11358173076923077, 0.06430288461538461, 0.14903846153846154, 0.05348557692307692, 0.02283653846153846], [736584.0, 0.07170542635658915, 0.06782945736434108, 0.0377906976744186, 0.013565891472868217, 0.06395348837209303, 0.06976744186046512, 0.09205426356589147, 0.08527131782945736, 0.040697674418604654, 0.1124031007751938, 0.0687984496124031, 0.17248062015503876, 0.03972868217054264, 0.035852713178294575], [736585.0, 0.03806584362139918, 0.06378600823045268, 0.01440329218106996, 0.01954732510288066, 0.04526748971193416, 0.07921810699588477, 0.11625514403292181, 0.10185185185185185, 0.037037037037037035, 0.15637860082304528, 0.06481481481481481, 0.17901234567901234, 0.040123456790123455, 0.01748971193415638], [736586.0, 0.05334987593052109, 0.08064516129032258, 0.011166253101736972, 0.0024813895781637717, 0.04466501240694789, 0.11166253101736973, 0.12034739454094293, 0.08312655086848635, 0.03225806451612903, 0.10173697270471464, 0.05955334987593052, 0.20471464019851116, 0.05459057071960298, 0.01488833746898263], [736587.0, 0.05906040268456376, 0.07516778523489932, 0.009395973154362415, 0.013422818791946308, 0.06308724832214765, 0.038926174496644296, 0.11677852348993288, 0.10469798657718121, 0.02953020134228188, 0.0738255033557047, 0.07651006711409396, 0.23624161073825503, 0.042953020134228186, 0.024161073825503355], [736588.0, 0.06282722513089005, 0.04712041884816754, 0.010471204188481676, 0.010471204188481676, 0.0549738219895288, 0.09162303664921466, 0.07329842931937172, 0.05235602094240838, 0.034031413612565446, 0.08115183246073299, 0.12827225130890052, 0.21727748691099477, 0.06544502617801047, 0.020942408376963352], [736589.0, 0.09063444108761329, 0.045317220543806644, 0.02416918429003021, 0.03625377643504532, 0.04229607250755287, 0.045317220543806644, 0.06948640483383686, 0.08459214501510574, 0.04229607250755287, 0.10574018126888217, 0.07250755287009064, 0.21450151057401812, 0.0634441087613293, 0.012084592145015106], [736590.0, 0.06993006993006994, 0.04020979020979021, 0.024475524475524476, 0.0472027972027972, 0.05944055944055944, 0.038461538461538464, 0.09965034965034965, 0.08216783216783216, 0.012237762237762238, 0.08916083916083917, 0.08391608391608392, 0.22727272727272727, 0.07867132867132867, 0.01048951048951049], [736591.0, 0.05909090909090909, 0.04696969696969697, 0.01818181818181818, 0.03636363636363636, 0.05606060606060606, 0.031818181818181815, 0.11515151515151516, 0.09545454545454546, 0.02878787878787879, 0.11363636363636363, 0.08787878787878788, 0.19090909090909092, 0.07272727272727272, 0.015151515151515152], [736592.0, 0.055031446540880505, 0.05345911949685535, 0.036163522012578615, 0.05817610062893082, 0.055031446540880505, 0.01729559748427673, 0.10062893081761007, 0.09433962264150944, 0.018867924528301886, 0.0770440251572327, 0.0959119496855346, 0.21069182389937108, 0.07547169811320754, 0.015723270440251572], [736593.0, 0.03281519861830743, 0.07081174438687392, 0.022452504317789293, 0.04835924006908463, 0.06390328151986183, 0.03626943005181347, 0.08635578583765112, 0.07599309153713299, 0.03281519861830743, 0.09153713298791019, 0.10880829015544041, 0.20379965457685664, 0.06735751295336788, 0.027633851468048358], [736594.0, 0.05357142857142857, 0.060267857142857144, 0.008928571428571428, 0.03794642857142857, 0.05133928571428571, 0.046875, 0.09598214285714286, 0.046875, 0.017857142857142856, 0.10044642857142858, 0.10714285714285714, 0.234375, 0.05803571428571429, 0.026785714285714284], [736595.0, 0.05723905723905724, 0.05723905723905724, 0.03367003367003367, 0.037037037037037035, 0.08417508417508418, 0.037037037037037035, 0.10774410774410774, 0.050505050505050504, 0.016835016835016835, 0.04377104377104377, 0.09764309764309764, 0.26262626262626265, 0.04713804713804714, 0.016835016835016835], [736596.0, 0.049773755656108594, 0.03167420814479638, 0.01809954751131222, 0.02262443438914027, 0.06787330316742081, 0.06787330316742081, 0.09954751131221719, 0.05429864253393665, 0.013574660633484163, 0.07239819004524888, 0.09954751131221719, 0.2398190045248869, 0.03167420814479638, 0.049773755656108594], [736597.0, 0.05513784461152882, 0.07268170426065163, 0.047619047619047616, 0.022556390977443608, 0.03759398496240601, 0.042606516290726815, 0.11528822055137844, 0.09273182957393483, 0.03258145363408521, 0.09273182957393483, 0.07017543859649122, 0.20300751879699247, 0.05513784461152882, 0.015037593984962405], [736598.0, 0.06839186691312385, 0.04251386321626617, 0.014787430683918669, 0.029574861367837338, 0.07024029574861368, 0.033271719038817, 0.08502772643253234, 0.08317929759704251, 0.025878003696857672, 0.10166358595194085, 0.09796672828096119, 0.23475046210720887, 0.051756007393715345, 0.025878003696857672], [736599.0, 0.040339702760084924, 0.07855626326963906, 0.010615711252653927, 0.025477707006369428, 0.06157112526539278, 0.055201698513800426, 0.08280254777070063, 0.08917197452229299, 0.03397027600849257, 0.07430997876857749, 0.05732484076433121, 0.25477707006369427, 0.07430997876857749, 0.03184713375796178], [736600.0, 0.10328638497652583, 0.07746478873239436, 0.011737089201877934, 0.023474178403755867, 0.03051643192488263, 0.035211267605633804, 0.07042253521126761, 0.08685446009389672, 0.018779342723004695, 0.09624413145539906, 0.08685446009389672, 0.23943661971830985, 0.051643192488262914, 0.02112676056338028], [736601.0, 0.08878504672897196, 0.053738317757009345, 0.02570093457943925, 0.03271028037383177, 0.053738317757009345, 0.035046728971962614, 0.10981308411214953, 0.08878504672897196, 0.016355140186915886, 0.08177570093457943, 0.08644859813084112, 0.22429906542056074, 0.037383177570093455, 0.02336448598130841]]}, "id": "el3018140537104096848"});
            })
         });
}
</script>